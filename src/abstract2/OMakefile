BYTE_ENABLED = true
NATIVE_ENABLED = true

USE_OCAMLFIND = true
OCAMLDEPFLAGS += -syntax camlp4o
OCAMLFLAGS += -thread -syntax camlp4o

LIBRARY = libabstract

OCAMLPACKS[] =
	str
	threads
	type_conv
	bin_prot
	sexplib
	sexplib.syntax
	oUnit

FILES[] =
	util
	mask

section
	.DEFAULT: $(OCamlLibrary $(LIBRARY), $(FILES))

section
	PROGRAM = test

	TEST_FILES[] =
		util_test
		mask_test
		all_test

	comma = ,
	OCAML_FIND_PACKAGES = -package $(concat $(comma),$(OCAMLPACKS))
	.DEFAULT: $(OCamlProgram $(PROGRAM), $(FILES) $(TEST_FILES))
		ocamlfind ocamldoc \
			-thread -syntax camlp4o \
			$(OCAML_FIND_PACKAGES) \
			-html -d doc \
			*.mli
		./test